<!DOCTYPE html>
<html lang="vi" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Story - Ứng Dụng Kỷ Niệm</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #006B68;
            --secondary-color: #FFC62F;
            --accent-color: #FFFFFF;
            --text-color: #1F2937;
            --bg-color: #F9FAFB;
            --gradient-start: #667eea;
            --gradient-end: #764ba2;
        }

        .theme-spring {
            --primary-color: #10B981;
            --secondary-color: #F59E0B;
            --accent-color: #ECFDF5;
            --text-color: #065F46;
            --bg-color: #F0FDF4;
            --gradient-start: #84fab0;
            --gradient-end: #8fd3f4;
        }

        .theme-summer {
            --primary-color: #F59E0B;
            --secondary-color: #EF4444;
            --accent-color: #FEF3C7;
            --text-color: #92400E;
            --bg-color: #FFFBEB;
            --gradient-start: #fa709a;
            --gradient-end: #fee140;
        }

        .theme-night {
            --primary-color: #1E293B;
            --secondary-color: #7C3AED;
            --accent-color: #0F172A;
            --text-color: #E2E8F0;
            --bg-color: #020617;
            --gradient-start: #2c3e50;
            --gradient-end: #4a6741;
        }

        .theme-romantic {
            --primary-color: #EC4899;
            --secondary-color: #F472B6;
            --accent-color: #FDF2F8;
            --text-color: #831843;
            --bg-color: #FCE7F3;
            --gradient-start: #ff9a9e;
            --gradient-end: #fecfef;
        }

        .bg-primary { background-color: var(--primary-color); }
        .bg-secondary { background-color: var(--secondary-color); }
        .bg-accent { background-color: var(--accent-color); }
        .text-primary { color: var(--primary-color); }
        .text-secondary { color: var(--secondary-color); }
        .text-custom { color: var(--text-color); }
        .bg-custom { background-color: var(--bg-color); }
        .border-primary { border-color: var(--primary-color); }

        .bg-gradient {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .floating-nav {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 40;
        }

        .nav-item {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-item:hover {
            transform: scale(1.1);
        }

        .nav-item.active {
            background: var(--primary-color);
            color: white;
        }

        .nav-item::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .nav-item:hover::before {
            opacity: 1;
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100%;
            width: 280px;
            background: linear-gradient(180deg, var(--gradient-start), var(--gradient-end));
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: 50;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .content-area {
            margin-left: 0;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            padding-top: 2rem;
        }

        .content-area.sidebar-open {
            margin-left: 280px;
        }

        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .heart-beat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        .modal-backdrop {
            backdrop-filter: blur(8px);
        }

        .grid-photos {
            display: grid;
            gap: 1.5rem;
        }

        .grid-1 { grid-template-columns: 1fr; }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-5 { grid-template-columns: repeat(5, 1fr); }
        .grid-6 { grid-template-columns: repeat(6, 1fr); }

        @media (max-width: 768px) {
            .grid-4, .grid-5, .grid-6 { grid-template-columns: repeat(2, 1fr); }
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
            .sidebar { width: 100%; }
            .content-area.sidebar-open { margin-left: 0; }
        }

        .photo-item {
            aspect-ratio: 1;
            overflow: hidden;
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .photo-item:hover {
            transform: scale(1.05) rotate(2deg);
        }

        .photo-item::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent 60%, rgba(255,255,255,0.3));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-item:hover::after {
            opacity: 1;
        }

        .timeline-item {
            position: relative;
            padding-left: 3rem;
            margin-bottom: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 0;
            bottom: -2rem;
            width: 3px;
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            border-radius: 2px;
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 1.5rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            background: var(--secondary-color);
            border: 3px solid white;
            box-shadow: 0 0 0 3px var(--primary-color);
        }

        .stats-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .floating-action {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 30;
        }

        .floating-action:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .hero-section {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="hearts" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><text x="10" y="15" text-anchor="middle" fill="rgba(255,255,255,0.1)" font-size="12">♥</text></pattern></defs><rect width="100" height="100" fill="url(%23hearts)"/></svg>');
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
    </style>
</head>
<body class="h-full bg-custom text-custom font-sans">
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar glass-effect">
        <div class="p-6">
            <!-- Logo -->
            <div class="flex items-center space-x-3 mb-8">
                <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                    <i class="fas fa-heart text-2xl heart-beat text-white"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-white">Love Story</h1>
                    <p class="text-sm text-white text-opacity-70">Ứng dụng kỷ niệm</p>
                </div>
            </div>

            <!-- Profile -->
            <div class="bg-white bg-opacity-10 rounded-xl p-4 mb-6">
                <div class="flex items-center space-x-3">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 48 48'%3E%3Ccircle cx='24' cy='24' r='24' fill='%23FFC62F'/%3E%3Ctext x='24' y='30' text-anchor='middle' fill='white' font-size='18' font-weight='bold'%3EH%3C/text%3E%3C/svg%3E" alt="Avatar" class="w-12 h-12 rounded-full">
                    <div>
                        <h3 class="font-medium text-white">Hà Mạnh Tín</h3>
                        <p class="text-sm text-white text-opacity-70">Quản trị viên</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="space-y-2">
                <button onclick="showSection('home')" class="nav-sidebar-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-colors">
                    <i class="fas fa-home text-lg"></i>
                    <span>Trang Chủ</span>
                </button>
                <button onclick="showSection('chat')" class="nav-sidebar-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-colors">
                    <i class="fas fa-robot text-lg"></i>
                    <span>Chat AI</span>
                </button>
                <button onclick="showSection('timeline')" class="nav-sidebar-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-colors">
                    <i class="fas fa-clock text-lg"></i>
                    <span>Timeline</span>
                </button>
                <button onclick="showSection('photos')" class="nav-sidebar-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-colors">
                    <i class="fas fa-images text-lg"></i>
                    <span>Khoảnh Khắc</span>
                </button>
                <button onclick="showSection('settings')" class="nav-sidebar-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-colors">
                    <i class="fas fa-cog text-lg"></i>
                    <span>Cài Đặt</span>
                </button>
            </nav>

            <!-- Quick Stats -->
            <div class="mt-8 bg-white bg-opacity-10 rounded-xl p-4">
                <h4 class="text-white font-medium mb-3">Thống Kê Nhanh</h4>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between text-white text-opacity-80">
                        <span>Ngày bên nhau:</span>
                        <span id="sidebarDays" class="font-medium">0</span>
                    </div>
                    <div class="flex justify-between text-white text-opacity-80">
                        <span>Kỷ niệm:</span>
                        <span id="sidebarMemories" class="font-medium">0</span>
                    </div>
                    <div class="flex justify-between text-white text-opacity-80">
                        <span>Hình ảnh:</span>
                        <span id="sidebarPhotos" class="font-medium">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div id="contentArea" class="content-area">
        <!-- Top Bar -->
        <div class="fixed top-0 left-0 right-0 bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg border-b border-gray-200 z-30">
            <div class="flex items-center justify-between px-6 py-4">
                <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center space-x-4">
                    <button onclick="openSearchModal()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i class="fas fa-search text-xl"></i>
                    </button>
                    <button onclick="openProfileModal()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i class="fas fa-user text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Home Section -->
        <div id="homeSection" class="section pt-20">
            <!-- Hero Section -->
            <div class="hero-section rounded-3xl mx-6 mb-8 relative overflow-hidden">
                <div class="relative z-10 text-center text-white p-8">
                    <div class="mb-6">
                        <i class="fas fa-heart text-6xl heart-beat mb-4"></i>
                        <h1 class="text-4xl md:text-6xl font-bold mb-4">Love Story</h1>
                        <p class="text-xl md:text-2xl opacity-90">Kỷ niệm tình yêu của chúng ta</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                        <div class="stats-card rounded-2xl p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="herodays">0</div>
                            <div class="text-sm opacity-80">Ngày bên nhau</div>
                        </div>
                        <div class="stats-card rounded-2xl p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="heroMemories">0</div>
                            <div class="text-sm opacity-80">Kỷ niệm</div>
                        </div>
                        <div class="stats-card rounded-2xl p-6 text-center">
                            <div class="text-3xl font-bold mb-2" id="heroPhotos">0</div>
                            <div class="text-sm opacity-80">Hình ảnh</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Grid -->
            <div class="px-6 grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Ngày Này Năm Xưa -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-3xl shadow-lg p-8 card-hover">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient rounded-2xl flex items-center justify-center mr-4">
                                <i class="fas fa-calendar-day text-white text-xl"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">Ngày Này Năm Xưa</h2>
                                <p class="text-gray-600">Những kỷ niệm đáng nhớ</p>
                            </div>
                        </div>
                        <div id="todayMemories" class="space-y-6">
                            <!-- Skeleton Loading -->
                            <div class="skeleton h-32 rounded-2xl"></div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar Content -->
                <div class="space-y-8">
                    <!-- Sự Kiện Sắp Tới -->
                    <div class="bg-white rounded-3xl shadow-lg p-6 card-hover">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-gradient rounded-xl flex items-center justify-center mr-3">
                                <i class="fas fa-hourglass-half text-white"></i>
                            </div>
                            <h3 class="text-lg font-bold text-gray-800">Sắp Tới</h3>
                        </div>
                        <div id="upcomingEvents" class="space-y-4">
                            <div class="skeleton h-16 rounded-xl"></div>
                        </div>
                    </div>

                    <!-- Hoạt Động Gần Đây -->
                    <div class="bg-white rounded-3xl shadow-lg p-6 card-hover">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-gradient rounded-xl flex items-center justify-center mr-3">
                                <i class="fas fa-clock text-white"></i>
                            </div>
                            <h3 class="text-lg font-bold text-gray-800">Hoạt Động</h3>
                        </div>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-xl">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-plus text-blue-600 text-xs"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="font-medium">Thêm ảnh mới</p>
                                    <p class="text-gray-500 text-xs">2 giờ trước</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-xl">
                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-heart text-green-600 text-xs"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="font-medium">Tạo kỷ niệm mới</p>
                                    <p class="text-gray-500 text-xs">1 ngày trước</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat AI Section -->
        <div id="chatSection" class="section hidden pt-20">
            <div class="px-6">
                <div class="bg-white rounded-3xl shadow-lg overflow-hidden" style="height: 70vh;">
                    <div class="bg-gradient p-6 text-white">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center">
                                <i class="fas fa-robot text-2xl"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold">AI Assistant</h2>
                                <p class="opacity-90">Trợ lý thông minh cho Love Story</p>
                            </div>
                        </div>
                    </div>
                    <div class="flex-1 p-6 overflow-y-auto" id="chatMessages" style="height: calc(70vh - 200px);">
                        <div class="text-center text-gray-500 mt-8">
                            <div class="w-16 h-16 bg-gradient rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-heart text-white text-2xl"></i>
                            </div>
                            <p class="text-lg font-medium mb-2">Xin chào! Tôi là AI Assistant</p>
                            <p>Tôi có thể giúp bạn tìm kiếm kỷ niệm, thống kê hoặc trả lời câu hỏi về Love Story.</p>
                        </div>
                    </div>
                    <div class="p-6 border-t bg-gray-50">
                        <div class="flex space-x-3">
                            <input type="text" id="chatInput" placeholder="Hỏi AI về kỷ niệm của bạn..." class="flex-1 border-0 bg-white rounded-2xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <button onclick="sendChatMessage()" class="bg-gradient text-white px-6 py-3 rounded-2xl hover:opacity-90 transition-opacity">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline Section -->
        <div id="timelineSection" class="section hidden pt-20">
            <div class="px-6">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 space-y-4 sm:space-y-0">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800">Timeline Kỷ Niệm</h2>
                        <p class="text-gray-600 mt-1">Dòng thời gian tình yêu của chúng ta</p>
                    </div>
                    <button onclick="openEventModal()" class="bg-gradient text-white px-6 py-3 rounded-2xl hover:opacity-90 transition-opacity shadow-lg">
                        <i class="fas fa-plus mr-2"></i>Thêm Sự Kiện
                    </button>
                </div>
                <div class="bg-white rounded-3xl shadow-lg p-8">
                    <div id="timelineList" class="space-y-8">
                        <!-- Timeline items will be loaded here -->
                        <div class="skeleton h-32 rounded-2xl"></div>
                        <div class="skeleton h-32 rounded-2xl"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Photos Section -->
        <div id="photosSection" class="section hidden pt-20">
            <div class="px-6">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 space-y-4 sm:space-y-0">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800">Thư Viện Ảnh</h2>
                        <p class="text-gray-600 mt-1">Những khoảnh khắc đẹp nhất</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm text-gray-600">Hiển thị:</span>
                        <select id="photoViewMode" onchange="changePhotoView()" class="border-0 bg-white rounded-xl px-4 py-2 text-sm shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="grid-3">Lưới 3</option>
                            <option value="grid-2">Lưới 2</option>
                            <option value="grid-4">Lưới 4</option>
                            <option value="grid-5">Lưới 5</option>
                            <option value="grid-6">Lưới 6</option>
                            <option value="list">Danh sách</option>
                        </select>
                    </div>
                </div>
                <div class="bg-white rounded-3xl shadow-lg p-8">
                    <div id="photosGrid" class="grid-photos grid-3">
                        <!-- Photos will be loaded here -->
                    </div>
                    <div id="photosPagination" class="mt-8 flex justify-center">
                        <!-- Pagination will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settingsSection" class="section hidden pt-20">
            <div class="px-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">Cài Đặt</h2>
                    <p class="text-gray-600 mt-1">Tùy chỉnh ứng dụng theo ý thích</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Giao Diện -->
                    <div class="bg-white rounded-3xl shadow-lg p-8 card-hover">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient rounded-2xl flex items-center justify-center mr-4">
                                <i class="fas fa-palette text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Giao Diện</h3>
                                <p class="text-gray-600">Thay đổi theme và màu sắc</p>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <label class="block">
                                <span class="text-sm font-medium text-gray-700 mb-2 block">Chọn Theme:</span>
                                <select id="themeSelect" onchange="changeTheme()" class="w-full border-0 bg-gray-50 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="default">🎨 Mặc định</option>
                                    <option value="spring">🌸 Mùa xuân</option>
                                    <option value="summer">☀️ Mùa hè</option>
                                    <option value="night">🌙 Ban đêm</option>
                                    <option value="romantic">💕 Lãng mạn</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <!-- Tự Động Cập Nhật -->
                    <div class="bg-white rounded-3xl shadow-lg p-8 card-hover">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient rounded-2xl flex items-center justify-center mr-4">
                                <i class="fas fa-sync text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Tự Động Cập Nhật</h3>
                                <p class="text-gray-600">Đồng bộ dữ liệu</p>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <label class="flex items-center p-3 bg-gray-50 rounded-xl">
                                <input type="checkbox" id="autoSync" class="mr-3 w-5 h-5 text-blue-600 rounded">
                                <span class="font-medium">Đồng bộ tự động từ Google Drive</span>
                            </label>
                            <label class="block">
                                <span class="text-sm font-medium text-gray-700 mb-2 block">Tần suất:</span>
                                <select class="w-full border-0 bg-gray-50 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option>⏰ Mỗi giờ</option>
                                    <option>📅 Mỗi ngày</option>
                                    <option>📆 Mỗi tuần</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <!-- Nhật ký hoạt động -->
                    <div class="bg-white rounded-3xl shadow-lg p-8 card-hover">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient rounded-2xl flex items-center justify-center mr-4">
                                <i class="fas fa-history text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Nhật Ký Hoạt Động</h3>
                                <p class="text-gray-600">Theo dõi hoạt động</p>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <label class="flex items-center p-3 bg-gray-50 rounded-xl">
                                <input type="checkbox" id="enableLogs" checked class="mr-3 w-5 h-5 text-blue-600 rounded">
                                <span class="font-medium">Bật ghi nhật ký</span>
                            </label>
                            <div class="bg-blue-50 p-4 rounded-xl">
                                <p class="text-sm text-blue-800 mb-2">📊 Tổng số bản ghi: <span class="font-bold">1,247</span></p>
                                <button onclick="openLogsModal()" class="text-blue-600 hover:text-blue-800 font-medium text-sm">Xem chi tiết →</button>
                            </div>
                        </div>
                    </div>

                    <!-- Thông Tin Hệ Thống -->
                    <div class="bg-white rounded-3xl shadow-lg p-8 card-hover">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-gradient rounded-2xl flex items-center justify-center mr-4">
                                <i class="fas fa-info-circle text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Thông Tin Hệ Thống</h3>
                                <p class="text-gray-600">Trạng thái và thông số</p>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-xl">
                                <span class="text-gray-600">🔖 Phiên bản:</span>
                                <span class="font-bold text-gray-800">v2.1.0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded-xl">
                                <span class="text-gray-600">📂 GitHub:</span>
                                <span class="text-green-600 font-medium">✓ Kết nối</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded-xl">
                                <span class="text-gray-600">☁️ Google Drive:</span>
                                <span class="text-green-600 font-medium">✓ Kết nối</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-blue-50 rounded-xl">
                                <span class="text-gray-600">💾 Dung lượng:</span>
                                <span class="font-medium text-blue-800">2.3GB / 15GB</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded-xl">
                                <span class="text-gray-600">🌐 Trạng thái:</span>
                                <span id="onlineStatus" class="text-green-600 font-medium">✓ Online</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-xl">
                                <span class="text-gray-600">📝 Nhật ký chờ:</span>
                                <span class="font-medium text-gray-800">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Action Button -->
        <button onclick="openEventModal()" class="floating-action">
            <i class="fas fa-plus text-xl"></i>
        </button>

        <!-- Floating Navigation -->
        <div class="floating-nav">
            <div class="bg-white rounded-full shadow-2xl p-2 flex space-x-2">
                <button onclick="showSection('home')" class="nav-item bg-primary text-white" data-tooltip="Trang Chủ">
                    <i class="fas fa-home"></i>
                </button>
                <button onclick="showSection('chat')" class="nav-item bg-gray-100 text-gray-600 hover:bg-gray-200" data-tooltip="Chat AI">
                    <i class="fas fa-robot"></i>
                </button>
                <button onclick="showSection('timeline')" class="nav-item bg-gray-100 text-gray-600 hover:bg-gray-200" data-tooltip="Timeline">
                    <i class="fas fa-clock"></i>
                </button>
                <button onclick="showSection('photos')" class="nav-item bg-gray-100 text-gray-600 hover:bg-gray-200" data-tooltip="Ảnh">
                    <i class="fas fa-images"></i>
                </button>
                <button onclick="showSection('settings')" class="nav-item bg-gray-100 text-gray-600 hover:bg-gray-200" data-tooltip="Cài Đặt">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </div>

        <!-- Footer -->
        <footer class="bg-gray-100 border-t mt-auto">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-sm text-gray-600">
                <p>Bản quyền thuộc về: Hà Mạnh Tín</p>
                <p>© 2025 - Ứng dụng kỷ niệm</p>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Photo Modal -->
    <div id="photoModal" class="fixed inset-0 bg-black bg-opacity-75 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl max-h-full overflow-auto">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 class="text-lg font-bold">Xem Ảnh</h3>
                <button onclick="closePhotoModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:space-x-4">
                    <div class="flex-1">
                        <img id="modalPhoto" src="" alt="" class="w-full h-auto rounded-lg">
                    </div>
                    <div class="lg:w-80 space-y-4">
                        <div class="flex space-x-2">
                            <button onclick="likePhoto()" class="flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600">
                                <i class="fas fa-heart mr-2"></i>Thích
                            </button>
                            <button onclick="openShareModal()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">
                                <i class="fas fa-share mr-2"></i>Chia sẻ
                            </button>
                        </div>
                        <div>
                            <h4 class="font-bold mb-2">Bình luận</h4>
                            <div id="photoComments" class="space-y-2 max-h-40 overflow-y-auto">
                                <!-- Comments will be loaded here -->
                            </div>
                            <div class="mt-2">
                                <input type="text" id="commentInput" placeholder="Thêm bình luận..." class="w-full border rounded px-3 py-2 text-sm">
                                <button onclick="addComment()" class="mt-2 w-full bg-primary text-white py-2 rounded hover:opacity-90">
                                    Gửi
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-md w-full">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 class="text-lg font-bold" id="eventModalTitle">Thêm Sự Kiện</h3>
                <button onclick="closeEventModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form onsubmit="saveEvent(event)" class="p-4 space-y-4">
                <input type="hidden" id="eventId">
                <div>
                    <label class="block text-sm font-medium mb-1">Tên sự kiện:</label>
                    <input type="text" id="eventName" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Ngày:</label>
                    <input type="date" id="eventDate" required class="w-full border rounded-lg px-3 py-2">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Mô tả:</label>
                    <textarea id="eventDescription" rows="3" class="w-full border rounded-lg px-3 py-2"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Ảnh:</label>
                    <button type="button" onclick="openImageSelector()" class="w-full border-2 border-dashed border-gray-300 rounded-lg py-4 text-center hover:border-primary">
                        <i class="fas fa-images text-2xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600">Chọn ảnh từ thư viện</p>
                    </button>
                    <div id="selectedImages" class="mt-2 grid grid-cols-4 gap-2"></div>
                </div>
                <div class="flex space-x-2">
                    <button type="button" onclick="closeEventModal()" class="flex-1 border border-gray-300 py-2 rounded-lg hover:bg-gray-50">
                        Hủy
                    </button>
                    <button type="submit" class="flex-1 bg-primary text-white py-2 rounded-lg hover:opacity-90">
                        Lưu
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-md w-full">
            <div class="p-4 border-b flex justify-between items-center">
                <h3 class="text-lg font-bold">Hồ Sơ Cá Nhân</h3>
                <button onclick="closeProfileModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4 space-y-4">
                <div class="text-center">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FFC62F'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EH%3C/text%3E%3C/svg%3E" alt="Avatar" class="w-20 h-20 rounded-full mx-auto mb-2">
                    <button class="text-primary hover:underline text-sm">Đổi avatar</button>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Họ tên:</label>
                    <input type="text" value="Hà Mạnh Tín" class="w-full border rounded-lg px-3 py-2">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Tên đăng nhập:</label>
                    <input type="text" value="hamanhtin" class="w-full border rounded-lg px-3 py-2">
                </div>
                <div class="text-sm text-gray-600">
                    <p><strong>Thiết bị:</strong> Chrome 120.0 trên Windows 11</p>
                    <p><strong>Đăng nhập lần cuối:</strong> 15/01/2025 14:30</p>
                </div>
                <div class="flex space-x-2">
                    <button onclick="closeProfileModal()" class="flex-1 border border-gray-300 py-2 rounded-lg hover:bg-gray-50">
                        Đóng
                    </button>
                    <button class="flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600">
                        Đăng xuất
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="searchModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-hidden">
            <div class="p-4 border-b">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-search text-gray-400"></i>
                    <input type="text" id="searchInput" placeholder="Tìm kiếm sự kiện, ảnh hoặc hỏi AI..." class="flex-1 outline-none text-lg">
                    <button onclick="closeSearchModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-4 overflow-y-auto max-h-80">
                <div class="space-y-2">
                    <p class="text-sm text-gray-600 mb-3">Gợi ý nhanh:</p>
                    <button class="block w-full text-left px-3 py-2 hover:bg-gray-100 rounded text-sm">
                        Tìm ảnh chụp tháng 12/2024
                    </button>
                    <button class="block w-full text-left px-3 py-2 hover:bg-gray-100 rounded text-sm">
                        Sự kiện sinh nhật
                    </button>
                    <button class="block w-full text-left px-3 py-2 hover:bg-gray-100 rounded text-sm">
                        Thống kê năm 2024
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 'home';
        let currentPhotoPage = 1;
        let photosPerPage = 12;
        let currentPhotoView = 'grid-3';
        let selectedEventImages = [];
        let currentEditingEvent = null;

        // Sample data
        const sampleEvents = [
            {
                id: 1,
                name: "Ngày đầu gặp nhau",
                date: "2022-02-22",
                description: "Ngày đặc biệt khi chúng ta bắt đầu câu chuyện tình yêu",
                images: [1, 2]
            },
            {
                id: 2,
                name: "Sinh nhật lần đầu cùng nhau",
                date: "2022-08-15",
                description: "Sinh nhật đầu tiên được tổ chức cùng nhau",
                images: [3, 4, 5]
            },
            {
                id: 3,
                name: "Kỷ niệm 1 năm",
                date: "2023-02-22",
                description: "Tròn 1 năm bên nhau, nhiều kỷ niệm đẹp",
                images: [6, 7]
            },
            {
                id: 4,
                name: "Chuyến du lịch Đà Lạt",
                date: "2023-12-24",
                description: "Chuyến du lịch lãng mạn tại thành phố ngàn hoa",
                images: [8, 9, 10]
            },
            {
                id: 5,
                name: "Tết Nguyên Đán 2024",
                date: "2024-02-10",
                description: "Tết đầu tiên được về nhà nhau",
                images: [11, 12]
            }
        ];

        const samplePhotos = Array.from({length: 50}, (_, i) => ({
            id: i + 1,
            url: `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Crect width='300' height='300' fill='%23${Math.floor(Math.random()*16777215).toString(16)}'/%3E%3Ctext x='150' y='150' text-anchor='middle' fill='white' font-size='24' font-weight='bold'%3EẢnh ${i + 1}%3C/text%3E%3C/svg%3E`,
            title: `Ảnh kỷ niệm ${i + 1}`,
            date: new Date(2022, 0, 1 + i * 7).toISOString().split('T')[0],
            likes: Math.floor(Math.random() * 50),
            comments: []
        }));

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadHomeData();
            updateOnlineStatus();
            
            // Set up keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'k') {
                    e.preventDefault();
                    openSearchModal();
                }
            });

            // Set up chat input
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
        });

        // Navigation functions
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update floating navigation
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-gray-100', 'text-gray-600', 'hover:bg-gray-200');
            });
            
            // Update sidebar navigation
            document.querySelectorAll('.nav-sidebar-btn').forEach(btn => {
                btn.classList.remove('bg-white', 'bg-opacity-20');
            });
            
            // Highlight active nav item
            const activeNavItem = document.querySelector(`[onclick="showSection('${section}')"]`);
            if (activeNavItem) {
                if (activeNavItem.classList.contains('nav-item')) {
                    activeNavItem.classList.remove('bg-gray-100', 'text-gray-600', 'hover:bg-gray-200');
                    activeNavItem.classList.add('bg-primary', 'text-white');
                } else if (activeNavItem.classList.contains('nav-sidebar-btn')) {
                    activeNavItem.classList.add('bg-white', 'bg-opacity-20');
                }
            }
            
            currentSection = section;
            
            // Load section data
            switch(section) {
                case 'timeline':
                    loadTimelineData();
                    break;
                case 'photos':
                    loadPhotosData();
                    break;
                case 'chat':
                    // Chat is already initialized
                    break;
            }
            
            // Close sidebar on mobile
            if (window.innerWidth < 768) {
                closeSidebar();
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('contentArea');
            
            sidebar.classList.toggle('open');
            if (window.innerWidth >= 768) {
                contentArea.classList.toggle('sidebar-open');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('contentArea');
            
            sidebar.classList.remove('open');
            contentArea.classList.remove('sidebar-open');
        }

        // Home section functions
        function loadHomeData() {
            setTimeout(() => {
                loadTodayMemories();
                loadUpcomingEvents();
                loadStatistics();
            }, 1000);
        }

        function loadTodayMemories() {
            const today = new Date();
            const todayStr = `${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            
            const memories = sampleEvents.filter(event => {
                const eventDate = new Date(event.date);
                const eventStr = `${String(eventDate.getMonth() + 1).padStart(2, '0')}-${String(eventDate.getDate()).padStart(2, '0')}`;
                return eventStr === todayStr && eventDate.getFullYear() < today.getFullYear();
            });

            const container = document.getElementById('todayMemories');
            
            if (memories.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-calendar-times text-4xl mb-4"></i>
                        <p>Không có kỷ niệm nào trong ngày hôm nay</p>
                    </div>
                `;
            } else {
                container.innerHTML = memories.map(memory => `
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 hover:shadow-lg transition-all duration-300 fade-in card-hover">
                        <div class="flex items-start space-x-4">
                            <div class="relative">
                                <img src="${samplePhotos[memory.images[0] - 1].url}" alt="" class="w-20 h-20 rounded-2xl object-cover shadow-md">
                                <div class="absolute -top-2 -right-2 w-8 h-8 bg-gradient rounded-full flex items-center justify-center">
                                    <i class="fas fa-heart text-white text-sm"></i>
                                </div>
                            </div>
                            <div class="flex-1">
                                <h4 class="text-xl font-bold text-gray-800 mb-2">${memory.name}</h4>
                                <div class="flex items-center space-x-2 mb-3">
                                    <div class="bg-white bg-opacity-70 rounded-full px-3 py-1">
                                        <span class="text-sm font-medium text-gray-700">${formatDate(memory.date)}</span>
                                    </div>
                                    <div class="bg-yellow-100 rounded-full px-3 py-1">
                                        <span class="text-sm font-medium text-yellow-800">${getYearsAgo(memory.date)} năm trước</span>
                                    </div>
                                </div>
                                <p class="text-gray-700 leading-relaxed">${memory.description}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function loadUpcomingEvents() {
            const today = new Date();
            const upcoming = [
                { name: "Kỷ niệm 3 năm", date: "2025-02-22", days: Math.ceil((new Date("2025-02-22") - today) / (1000 * 60 * 60 * 24)) },
                { name: "Sinh nhật", date: "2025-08-15", days: Math.ceil((new Date("2025-08-15") - today) / (1000 * 60 * 60 * 24)) }
            ].filter(event => event.days > 0);

            const container = document.getElementById('upcomingEvents');
            
            if (upcoming.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4 text-gray-500">
                        <p class="text-sm">Không có sự kiện sắp tới</p>
                    </div>
                `;
            } else {
                container.innerHTML = upcoming.map(event => `
                    <div class="bg-gradient-to-r from-pink-50 to-red-50 rounded-xl p-4 fade-in border-l-4 border-pink-400">
                        <div class="flex justify-between items-center">
                            <div class="flex-1">
                                <h5 class="font-bold text-gray-800 mb-1">${event.name}</h5>
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-calendar text-pink-500 text-sm"></i>
                                    <span class="text-sm text-gray-600">${formatDate(event.date)}</span>
                                </div>
                            </div>
                            <div class="text-center ml-4">
                                <div class="w-12 h-12 bg-gradient rounded-xl flex items-center justify-center mb-1">
                                    <span class="text-lg font-bold text-white">${event.days}</span>
                                </div>
                                <div class="text-xs text-gray-600 font-medium">ngày</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function loadStatistics() {
            const startDate = new Date('2022-02-22');
            const today = new Date();
            const daysTogether = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
            
            // Update hero stats
            document.getElementById('herodays').textContent = daysTogether.toLocaleString();
            document.getElementById('heroMemories').textContent = sampleEvents.length;
            document.getElementById('heroPhotos').textContent = samplePhotos.length;
            
            // Update sidebar stats
            document.getElementById('sidebarDays').textContent = daysTogether.toLocaleString();
            document.getElementById('sidebarMemories').textContent = sampleEvents.length;
            document.getElementById('sidebarPhotos').textContent = samplePhotos.length;
        }

        // Timeline functions
        function loadTimelineData() {
            const container = document.getElementById('timelineList');
            
            setTimeout(() => {
                const sortedEvents = [...sampleEvents].sort((a, b) => new Date(b.date) - new Date(a.date));
                
                container.innerHTML = sortedEvents.map(event => `
                    <div class="timeline-item fade-in">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h4 class="font-bold text-primary">${event.name}</h4>
                                    <p class="text-sm text-gray-600">${formatDate(event.date)}</p>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editEvent(${event.id})" class="text-blue-500 hover:text-blue-700">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="viewEventPhotos(${event.id})" class="text-green-500 hover:text-green-700">
                                        <i class="fas fa-images"></i>
                                    </button>
                                    <button onclick="deleteEvent(${event.id})" class="text-red-500 hover:text-red-700">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-sm mb-3">${event.description}</p>
                            <div class="flex space-x-2">
                                ${event.images.slice(0, 3).map(imgId => `
                                    <img src="${samplePhotos[imgId - 1].url}" alt="" class="w-12 h-12 rounded object-cover">
                                `).join('')}
                                ${event.images.length > 3 ? `<div class="w-12 h-12 bg-gray-200 rounded flex items-center justify-center text-xs">+${event.images.length - 3}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            }, 500);
        }

        // Photos functions
        function loadPhotosData() {
            const container = document.getElementById('photosGrid');
            const pagination = document.getElementById('photosPagination');
            
            const startIndex = (currentPhotoPage - 1) * photosPerPage;
            const endIndex = startIndex + photosPerPage;
            const pagePhotos = samplePhotos.slice(startIndex, endIndex);
            
            // Update grid class
            container.className = `grid-photos ${currentPhotoView}`;
            
            if (currentPhotoView === 'list') {
                container.innerHTML = pagePhotos.map(photo => `
                    <div class="flex items-center space-x-4 p-4 border rounded-lg hover:shadow-md transition-shadow cursor-pointer fade-in" onclick="openPhotoModal(${photo.id})">
                        <img src="${photo.url}" alt="${photo.title}" class="w-16 h-16 rounded object-cover">
                        <div class="flex-1">
                            <h4 class="font-medium">${photo.title}</h4>
                            <p class="text-sm text-gray-600">${formatDate(photo.date)}</p>
                            <p class="text-sm text-gray-500">
                                <i class="fas fa-heart text-red-500 mr-1"></i>${photo.likes} lượt thích
                            </p>
                        </div>
                    </div>
                `).join('');
            } else {
                container.innerHTML = pagePhotos.map(photo => `
                    <div class="photo-item fade-in" onclick="openPhotoModal(${photo.id})">
                        <img src="${photo.url}" alt="${photo.title}" class="w-full h-full object-cover">
                    </div>
                `).join('');
            }
            
            // Update pagination
            const totalPages = Math.ceil(samplePhotos.length / photosPerPage);
            pagination.innerHTML = `
                <div class="flex items-center space-x-2">
                    <button onclick="changePage(${currentPhotoPage - 1})" ${currentPhotoPage === 1 ? 'disabled' : ''} 
                            class="px-3 py-1 border rounded ${currentPhotoPage === 1 ? 'text-gray-400' : 'hover:bg-gray-50'}">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span class="text-sm">Trang ${currentPhotoPage} / ${totalPages}</span>
                    <button onclick="changePage(${currentPhotoPage + 1})" ${currentPhotoPage === totalPages ? 'disabled' : ''} 
                            class="px-3 py-1 border rounded ${currentPhotoPage === totalPages ? 'text-gray-400' : 'hover:bg-gray-50'}">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            `;
        }

        function changePhotoView() {
            currentPhotoView = document.getElementById('photoViewMode').value;
            loadPhotosData();
        }

        function changePage(page) {
            const totalPages = Math.ceil(samplePhotos.length / photosPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPhotoPage = page;
                loadPhotosData();
            }
        }

        // Modal functions
        function openPhotoModal(photoId) {
            const photo = samplePhotos.find(p => p.id === photoId);
            if (!photo) return;
            
            document.getElementById('modalPhoto').src = photo.url;
            document.getElementById('modalPhoto').alt = photo.title;
            
            // Load comments
            const commentsContainer = document.getElementById('photoComments');
            commentsContainer.innerHTML = photo.comments.length === 0 ? 
                '<p class="text-gray-500 text-sm">Chưa có bình luận nào</p>' :
                photo.comments.map(comment => `
                    <div class="text-sm">
                        <strong>${comment.author}:</strong> ${comment.text}
                    </div>
                `).join('');
            
            document.getElementById('photoModal').classList.remove('hidden');
        }

        function closePhotoModal() {
            document.getElementById('photoModal').classList.add('hidden');
        }

        function openEventModal(eventId = null) {
            currentEditingEvent = eventId;
            selectedEventImages = [];
            
            if (eventId) {
                const event = sampleEvents.find(e => e.id === eventId);
                if (event) {
                    document.getElementById('eventModalTitle').textContent = 'Sửa Sự Kiện';
                    document.getElementById('eventId').value = event.id;
                    document.getElementById('eventName').value = event.name;
                    document.getElementById('eventDate').value = event.date;
                    document.getElementById('eventDescription').value = event.description;
                    selectedEventImages = [...event.images];
                    updateSelectedImages();
                }
            } else {
                document.getElementById('eventModalTitle').textContent = 'Thêm Sự Kiện';
                document.getElementById('eventId').value = '';
                document.getElementById('eventName').value = '';
                document.getElementById('eventDate').value = '';
                document.getElementById('eventDescription').value = '';
                updateSelectedImages();
            }
            
            document.getElementById('eventModal').classList.remove('hidden');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.add('hidden');
        }

        function openProfileModal() {
            document.getElementById('profileModal').classList.remove('hidden');
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.add('hidden');
        }

        function openSearchModal() {
            document.getElementById('searchModal').classList.remove('hidden');
            document.getElementById('searchInput').focus();
        }

        function closeSearchModal() {
            document.getElementById('searchModal').classList.add('hidden');
        }

        function openLogsModal() {
            // Create a simple logs modal inline
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-hidden">
                    <div class="p-4 border-b flex justify-between items-center">
                        <h3 class="text-lg font-bold">Nhật Ký Hoạt Động</h3>
                        <button onclick="this.closest('.modal-backdrop').remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4 overflow-y-auto max-h-80">
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between py-2 border-b">
                                <span>Thêm ảnh mới</span>
                                <span class="text-gray-500">15/01/2025 14:30</span>
                            </div>
                            <div class="flex justify-between py-2 border-b">
                                <span>Tạo sự kiện "Tết 2025"</span>
                                <span class="text-gray-500">10/01/2025 09:15</span>
                            </div>
                            <div class="flex justify-between py-2 border-b">
                                <span>Đồng bộ từ Google Drive</span>
                                <span class="text-gray-500">08/01/2025 12:00</span>
                            </div>
                            <div class="flex justify-between py-2 border-b">
                                <span>Thay đổi theme</span>
                                <span class="text-gray-500">05/01/2025 16:45</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event functions
        function saveEvent(e) {
            e.preventDefault();
            
            const eventData = {
                id: document.getElementById('eventId').value || Date.now(),
                name: document.getElementById('eventName').value,
                date: document.getElementById('eventDate').value,
                description: document.getElementById('eventDescription').value,
                images: selectedEventImages
            };
            
            if (currentEditingEvent) {
                const index = sampleEvents.findIndex(e => e.id == currentEditingEvent);
                if (index !== -1) {
                    sampleEvents[index] = eventData;
                }
            } else {
                sampleEvents.push(eventData);
            }
            
            closeEventModal();
            if (currentSection === 'timeline') {
                loadTimelineData();
            }
            loadHomeData(); // Refresh home data
        }

        function editEvent(eventId) {
            openEventModal(eventId);
        }

        function deleteEvent(eventId) {
            // Create inline confirmation
            const confirmation = document.createElement('div');
            confirmation.className = 'fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 flex items-center justify-center p-4';
            confirmation.innerHTML = `
                <div class="bg-white rounded-lg max-w-sm w-full p-6">
                    <h3 class="text-lg font-bold mb-4">Xác nhận xóa</h3>
                    <p class="text-gray-600 mb-6">Bạn có chắc chắn muốn xóa sự kiện này không?</p>
                    <div class="flex space-x-2">
                        <button onclick="this.closest('.modal-backdrop').remove()" class="flex-1 border border-gray-300 py-2 rounded-lg hover:bg-gray-50">
                            Hủy
                        </button>
                        <button onclick="confirmDeleteEvent(${eventId}); this.closest('.modal-backdrop').remove()" class="flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600">
                            Xóa
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmation);
        }

        function confirmDeleteEvent(eventId) {
            const index = sampleEvents.findIndex(e => e.id == eventId);
            if (index !== -1) {
                sampleEvents.splice(index, 1);
                loadTimelineData();
                loadHomeData();
            }
        }

        function viewEventPhotos(eventId) {
            const event = sampleEvents.find(e => e.id === eventId);
            if (!event) return;
            
            // Create event photos modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-75 modal-backdrop z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-full overflow-auto">
                    <div class="p-4 border-b flex justify-between items-center">
                        <h3 class="text-lg font-bold">Ảnh của "${event.name}"</h3>
                        <button onclick="this.closest('.modal-backdrop').remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="p-4">
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                            ${event.images.map(imgId => `
                                <div class="photo-item cursor-pointer" onclick="openPhotoModal(${imgId})">
                                    <img src="${samplePhotos[imgId - 1].url}" alt="" class="w-full h-full object-cover rounded-lg">
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function openImageSelector() {
            // Create image selector modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-4xl w-full max-h-full overflow-hidden">
                    <div class="p-4 border-b flex justify-between items-center">
                        <h3 class="text-lg font-bold">Chọn Ảnh</h3>
                        <div class="flex items-center space-x-2">
                            <button onclick="selectAllImages()" class="text-sm text-primary hover:underline">Chọn tất cả</button>
                            <button onclick="deselectAllImages()" class="text-sm text-primary hover:underline">Bỏ chọn</button>
                            <button onclick="this.closest('.modal-backdrop').remove()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-4 overflow-y-auto max-h-96">
                        <div class="grid grid-cols-4 md:grid-cols-6 gap-2" id="imageSelectorGrid">
                            ${samplePhotos.slice(0, 24).map(photo => `
                                <div class="relative cursor-pointer image-selector-item" data-id="${photo.id}" onclick="toggleImageSelection(${photo.id})">
                                    <img src="${photo.url}" alt="" class="w-full aspect-square object-cover rounded">
                                    <div class="absolute top-1 right-1 w-6 h-6 bg-white rounded-full flex items-center justify-center shadow">
                                        <i class="fas fa-check text-primary text-sm hidden"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="p-4 border-t flex justify-between">
                        <span class="text-sm text-gray-600">Đã chọn: <span id="selectedCount">0</span> ảnh</span>
                        <button onclick="confirmImageSelection(); this.closest('.modal-backdrop').remove()" class="bg-primary text-white px-4 py-2 rounded-lg hover:opacity-90">
                            Xác nhận
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Update selection state
            updateImageSelectorState();
        }

        function toggleImageSelection(imageId) {
            const index = selectedEventImages.indexOf(imageId);
            if (index === -1) {
                selectedEventImages.push(imageId);
            } else {
                selectedEventImages.splice(index, 1);
            }
            updateImageSelectorState();
        }

        function selectAllImages() {
            selectedEventImages = samplePhotos.slice(0, 24).map(p => p.id);
            updateImageSelectorState();
        }

        function deselectAllImages() {
            selectedEventImages = [];
            updateImageSelectorState();
        }

        function updateImageSelectorState() {
            const items = document.querySelectorAll('.image-selector-item');
            items.forEach(item => {
                const id = parseInt(item.dataset.id);
                const checkbox = item.querySelector('i');
                if (selectedEventImages.includes(id)) {
                    checkbox.classList.remove('hidden');
                    item.classList.add('ring-2', 'ring-primary');
                } else {
                    checkbox.classList.add('hidden');
                    item.classList.remove('ring-2', 'ring-primary');
                }
            });
            
            const countElement = document.getElementById('selectedCount');
            if (countElement) {
                countElement.textContent = selectedEventImages.length;
            }
        }

        function confirmImageSelection() {
            updateSelectedImages();
        }

        function updateSelectedImages() {
            const container = document.getElementById('selectedImages');
            container.innerHTML = selectedEventImages.map(imgId => `
                <div class="relative">
                    <img src="${samplePhotos[imgId - 1].url}" alt="" class="w-full aspect-square object-cover rounded">
                    <button onclick="removeSelectedImage(${imgId})" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        function removeSelectedImage(imageId) {
            const index = selectedEventImages.indexOf(imageId);
            if (index !== -1) {
                selectedEventImages.splice(index, 1);
                updateSelectedImages();
            }
        }

        // Photo interaction functions
        function likePhoto() {
            // Simple like animation
            const button = event.target.closest('button');
            button.innerHTML = '<i class="fas fa-heart mr-2"></i>Đã thích';
            button.classList.remove('bg-red-500', 'hover:bg-red-600');
            button.classList.add('bg-red-600');
        }

        function addComment() {
            const input = document.getElementById('commentInput');
            const comment = input.value.trim();
            if (!comment) return;
            
            const commentsContainer = document.getElementById('photoComments');
            const newComment = document.createElement('div');
            newComment.className = 'text-sm fade-in';
            newComment.innerHTML = `<strong>Bạn:</strong> ${comment}`;
            
            if (commentsContainer.querySelector('.text-gray-500')) {
                commentsContainer.innerHTML = '';
            }
            
            commentsContainer.appendChild(newComment);
            input.value = '';
        }

        function openShareModal() {
            // Create share modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-md w-full">
                    <div class="p-4 border-b flex justify-between items-center">
                        <h3 class="text-lg font-bold">Chia Sẻ Ảnh</h3>
                        <button onclick="this.closest('.modal-backdrop').remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4 space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Link chia sẻ:</label>
                            <div class="flex">
                                <input type="text" value="https://lovestory.app/photo/123" readonly class="flex-1 border rounded-l-lg px-3 py-2 bg-gray-50">
                                <button onclick="copyToClipboard('https://lovestory.app/photo/123')" class="bg-primary text-white px-3 rounded-r-lg hover:opacity-90">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Chia sẻ qua:</label>
                            <div class="grid grid-cols-4 gap-2">
                                <button class="p-3 border rounded-lg hover:bg-gray-50 text-center">
                                    <i class="fab fa-facebook text-blue-600 text-xl mb-1"></i>
                                    <div class="text-xs">Facebook</div>
                                </button>
                                <button class="p-3 border rounded-lg hover:bg-gray-50 text-center">
                                    <i class="fab fa-twitter text-blue-400 text-xl mb-1"></i>
                                    <div class="text-xs">Twitter</div>
                                </button>
                                <button class="p-3 border rounded-lg hover:bg-gray-50 text-center">
                                    <i class="fab fa-instagram text-pink-600 text-xl mb-1"></i>
                                    <div class="text-xs">Instagram</div>
                                </button>
                                <button onclick="generateQR()" class="p-3 border rounded-lg hover:bg-gray-50 text-center">
                                    <i class="fas fa-qrcode text-gray-600 text-xl mb-1"></i>
                                    <div class="text-xs">QR Code</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Chat functions
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            
            const container = document.getElementById('chatMessages');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'mb-4 fade-in';
            userMsg.innerHTML = `
                <div class="flex justify-end">
                    <div class="bg-primary text-white rounded-lg px-4 py-2 max-w-xs">
                        ${message}
                    </div>
                </div>
            `;
            container.appendChild(userMsg);
            
            // Add AI response
            setTimeout(() => {
                const aiMsg = document.createElement('div');
                aiMsg.className = 'mb-4 fade-in';
                aiMsg.innerHTML = `
                    <div class="flex">
                        <div class="bg-gray-100 rounded-lg px-4 py-2 max-w-xs">
                            ${getAIResponse(message)}
                        </div>
                    </div>
                `;
                container.appendChild(aiMsg);
                container.scrollTop = container.scrollHeight;
            }, 1000);
            
            input.value = '';
            container.scrollTop = container.scrollHeight;
        }

        function getAIResponse(message) {
            const responses = {
                'thống kê': `Hiện tại bạn có ${sampleEvents.length} kỷ niệm và ${samplePhotos.length} hình ảnh. Số ngày bên nhau: ${Math.floor((new Date() - new Date('2022-02-22')) / (1000 * 60 * 60 * 24))} ngày.`,
                'ảnh': `Tôi tìm thấy ${samplePhotos.length} ảnh trong thư viện của bạn. Ảnh mới nhất được thêm vào hôm nay.`,
                'sự kiện': `Bạn có ${sampleEvents.length} sự kiện đã lưu. Sự kiện gần nhất là "${sampleEvents[sampleEvents.length - 1].name}".`,
                'default': 'Tôi có thể giúp bạn tìm kiếm kỷ niệm, xem thống kê hoặc trả lời câu hỏi về Love Story. Hãy thử hỏi về "thống kê", "ảnh" hoặc "sự kiện"!'
            };
            
            const key = Object.keys(responses).find(k => message.toLowerCase().includes(k));
            return responses[key] || responses.default;
        }

        // Theme functions
        function changeTheme() {
            const theme = document.getElementById('themeSelect').value;
            document.body.className = document.body.className.replace(/theme-\w+/g, '');
            
            if (theme !== 'default') {
                document.body.classList.add(`theme-${theme}`);
            }
        }

        // Utility functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('vi-VN');
        }

        function getYearsAgo(dateString) {
            const date = new Date(dateString);
            const today = new Date();
            return today.getFullYear() - date.getFullYear();
        }

        function updateOnlineStatus() {
            const statusElement = document.getElementById('onlineStatus');
            if (navigator.onLine) {
                statusElement.innerHTML = '✓ Online';
                statusElement.className = 'text-green-600';
            } else {
                statusElement.innerHTML = '✗ Offline';
                statusElement.className = 'text-red-600';
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show success message
                const button = event.target.closest('button');
                const originalContent = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i>';
                setTimeout(() => {
                    button.innerHTML = originalContent;
                }, 1000);
            });
        }

        function generateQR() {
            // Simple QR code placeholder
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 text-center">
                    <h3 class="text-lg font-bold mb-4">Mã QR</h3>
                    <div class="w-48 h-48 bg-gray-200 mx-auto mb-4 flex items-center justify-center">
                        <i class="fas fa-qrcode text-6xl text-gray-400"></i>
                    </div>
                    <p class="text-sm text-gray-600 mb-4">Quét mã QR để xem ảnh</p>
                    <button onclick="this.closest('.modal-backdrop').remove()" class="bg-primary text-white px-4 py-2 rounded-lg">
                        Đóng
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event listeners
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98ed438e56f01fca',t:'MTc2MDUwOTc4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
